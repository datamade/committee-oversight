{% extends "base.html" %}

{% block content %}
  <div class="row justify-content-center">
    <div class="col-12 col-md-10 text-center">
      <h2 class="my-2">{{ page.title }}</h2>
      <p class="lead font-weight-light mb-2 mt-3"><strong>Chair: </strong> {{ page.chair }}</p>
    </div>
  </div>

  <div class="row justify-content-center align-items-center">
    <div class="col-6 col-md-4 col-lg-3 col-xl-3 my-3 pr-4 text-right border-right">
      <h3 class="rating-large b-plus-rating">B+</h3>
      <p>
        Projected CHP Score for the 116th Congress<br />
        <small><i>Last updated: {% now "jS F Y H:i" %}</i></small>
      </p>
    </div>

    <div class="col-6 col-md-5 col-lg-4 col-xl-3 my-3 pl-4 text-left">
      <p class="font-weight-light my-2"><strong>TK</strong> Investigative Oversight Hearings</p>
      <p class="font-weight-light my-2"><strong>TK</strong> Policy/Legislative Hearings</p>
      <p class="font-weight-light my-2"><strong>TK</strong> Total Hearings</p>
    </div>
  </div>

  <div class="row justify-content-center">
   <div class="col-12 col-lg-10 col-xl-6 my-2 font-weight-light">
     <div id="summary">
       <div class="collapse" id="collapseSummary">
         {{ page.body|safe }}
       </div>
       <a class="collapsed btn btn-back btn-center my-3" data-toggle="collapse" href="#collapseSummary" aria-expanded="false" aria-controls="collapseSummary"></a>
     </div>
     <hr />
   </div>
  </div>

  <div class="card mt-5 col-12 col-xl-10 mx-auto card-shadow">
    <h4 class="text-center mt-4">
      Committee History
    </h4>
    <div class="card-body">
      {% include 'partials/rating_table.html' %}
    </div>
  </div>

  <div class="card mt-5 col-12 col-xl-10 mx-auto card-shadow">
    <h4 class="text-center mt-4">
      Hearings held by the <br />
      {{ page.title }}
    </h4>
    <div class="card-body">
      {% include 'partials/hearing_table.html' %}
    </div>
  </div>

  <script>
    $(document).ready(function () {
        var committeeID = '{{ page.committee.id }}';
        function makeAjaxUrl(committeeID) {
          var ajaxUrl = "{% url 'order_list_json' %}" +
                 '?detail_type=committee' +
                 '&id=' + committeeID;
          return ajaxUrl;
        }
        $('#hearing-table').DataTable({
          "dom": "Bfrtip",
          "order": [[ 2, "desc" ]],
          "columnDefs": [{ "orderable": false, "targets": [3, 4] }],
          "processing": true,
          "serverSide": true,
          "ajax": makeAjaxUrl(committeeID)
        });
    });
  </script>
{% endblock %}
